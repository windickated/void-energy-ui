/*
 * ROLE: Tooltip skin overrides.
 * RESPONSIBILITY: Aligns Tippy.js surfaces with Glass Physics, Retro fallbacks, and light-mode variants.
 */

@use '../abstracts' as *;
@use '../base/typography' as *;

/* ==========================================================================
   VOID TOOLTIPS (TippyJS Override)
   ========================================================================== */

// 1. THE BOX (Physics & Skin)
.tippy-box[data-theme~='void'] {
  background-color: transparent;
  color: inherit;

  // High-Legibility Glass
  // We manually apply glass properties to override Tippy defaults
  background-color: fade(var(--bg-canvas), 90%);
  backdrop-filter: blur(var(--physics-blur));
  -webkit-backdrop-filter: blur(var(--physics-blur));

  border: var(--physics-border-width) solid var(--border-highlight);
  border-radius: var(--radius-base);
  box-shadow: var(--void-shadow, 0 10px 40px -10px rgba(0, 0, 0, 0.5));

  // Typography
  @include typography('caption');
  color: var(--text-main);
  text-align: center;
  padding: 0.25rem 0.5rem;

  // RETRO PHYSICS OVERRIDE (Robotic)
  @at-root [data-physics='retro'] & {
    background-color: var(--bg-canvas);
    backdrop-filter: none;
    border-radius: 0;
    box-shadow: none;
  }

  // LIGHT MODE OVERRIDE (Ink)
  @at-root [data-mode='light'] & {
    background-color: var(--bg-surface);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
}

// 2. THE CONTENT
.tippy-content {
  padding: 0.5rem 0.75rem; // Comfort padding
}

// 3. THE "MATERIALIZE" ANIMATION
// We replace 'scale.css' with this custom physics engine.
// Tippy toggles data-state between 'hidden' and 'visible'.

.tippy-box[data-animation='materialize'] {
  // --- STATE: HIDDEN (Dematerialized) ---
  &[data-state='hidden'] {
    opacity: 0;
    transform: scale(0.95) translateY(4px); // Slight drop
    filter: blur(calc(var(--physics-blur) / 4)); // Void Blur
  }

  // --- STATE: VISIBLE (Stabilized) ---
  &[data-state='visible'] {
    opacity: 1;
    transform: scale(1) translateY(0);
    filter: blur(0);

    // The Stabilization Curve
    transition-property: transform, opacity, filter;
    transition-duration: var(--speed-fast);
    transition-timing-function: var(--ease-stabilize);
  }

  // --- MODE / PHYSICS EXCEPTIONS ---

  // Retro physics: Instant Snap (0s)
  @at-root [data-physics='retro'] & {
    transition-duration: 0s !important; // Instant
    &[data-state='hidden'] {
      filter: none; // No blur in terminal
    }
  }

  // Light mode: Clean Fade (No Blur)
  @at-root [data-mode='light'] & {
    &[data-state='hidden'] {
      filter: none; // No blur in paper
    }
  }
}

// 4. ARROW HIDING
// We hide arrows because glass arrows are visually messy (double borders).
.tippy-arrow {
  display: none;
}
