/*
 * ROLE: Container and surface scaffolding.
 * RESPONSIBILITY: Governs layout widths and applies surface physics for cards, grids, and atomic surfaces.
 */

@use 'sass:map';
@use '../abstracts' as *;
@use '../base/typography';

/* ==========================================================================
   VOID ENERGY CONTAINER & SURFACE SYSTEM
   ==========================================================================
   
   PURPOSE:
   This file manages the "Frame" (Layout) and the "Skin" (Surfaces) of the UI.
   It separates width constraints from visual physics to allow maximum flexibility.

   PHILOSOPHY: "Separation of Concerns"
   1. Containers handle WIDTH and MARGINS.
   2. Surfaces handle BACKGROUNDS, BLURS, and BORDERS.
   
   --------------------------------------------------------------------------
   See global.scss for full API documentation.

   --------------------------------------------------------------------------
   COMMON PATTERNS (Copy-Paste)
   --------------------------------------------------------------------------

   A. THE STANDARD PAGE LAYOUT
      <div class="container flex-col gap-md">
         <h1>Title</h1>
         <p>Content...</p>
      </div>

   B. THE COMPOSABLE GLASS CARD (Preferred)
      <div class="surface-glass round-16 pad-md flex-col gap-md">
         <h2>Card Title</h2>
      </div>

   C. THE CLICKABLE WIDGET
      <div class="surface-glass-action round-16 pad-md flex-center">
         <span>Click Me</span>
      </div>

   -------------------------------------------------------------------------- */

// ==========================================================================
// 1. LAYOUT CONTAINERS (Structure)
// ==========================================================================

// STANDARD CONTAINER
// Role: Handles max-widths and margins across breakpoints.
// Logic: Pure layout. No visuals (blur/glow) by default.
.container {
  // 1. Base Mobile Styles (Zero config)
  width: 100%;
  margin-inline: auto; // Centers the container

  // Use 'base' padding from the map (16px)
  padding-inline: map.get($container-paddings, 'base');

  // 2. Responsive Loop
  // We iterate through the breakpoints map defined in _variables.scss
  @each $breakpoint-name, $breakpoint-width in $breakpoints {
    // Check if we have defined values for this specific breakpoint
    $target-width: map.get($container-widths, $breakpoint-name);
    $target-padding: map.get($container-paddings, $breakpoint-name);

    // Only generate media query if values exist
    @if $target-width and $target-padding {
      @include respond-up($breakpoint-name) {
        max-width: $target-width;
        padding-inline: $target-padding;
      }
    }
  }
}

// FLUID CONTAINER
// Role: Background sections that span viewport edge-to-edge.
// Logic: 100% width, but respects the grid's side padding.
.container-fluid {
  width: 100%;
  padding-inline: map.get($container-paddings, 'base');
  margin-inline: auto;
  max-width: none; // Unset the limit

  // Still respect responsive edge padding
  @each $breakpoint-name, $breakpoint-width in $breakpoints {
    $target-padding: map.get($container-paddings, $breakpoint-name);

    @if $target-padding {
      @include respond-up($breakpoint-name) {
        padding-inline: $target-padding;
      }
    }
  }
}

// ==========================================================================
// 2. PRESET CARDS (Layout + Visuals)
// ==========================================================================
// Use these when you want a standard "Section" block with spacing included.

.card-glass {
  @include glass-float();
  border-radius: var(--radius-lg);

  @at-root [data-physics='flat'] & {
    border-radius: var(--radius-md);
  }

  @at-root [data-physics='retro'] & {
    border-radius: var(--radius-base);
  }
}

.card-sunk {
  @include glass-sunk;
  border-radius: var(--radius-lg);

  @at-root [data-physics='flat'] & {
    border-radius: var(--radius-md);
  }

  @at-root [data-physics='retro'] & {
    border-radius: var(--radius-base);
  }
}

// ==========================================================================
// 3. ATOMIC SURFACES (Texture Only)
// ==========================================================================
// Purpose: Apply "Void Physics" to any element without enforcing layout/spacing.

// A. FLOATING SURFACES (Positive Z)
// --------------------------------------------------------------------------

// Static Glass (Decoration / Wrapper)
// Does not move on hover.
.surface-glass {
  @include glass-float($interactive: false);
  // No padding/margin/radius defined. Combine with _helpers.scss.
}

// Interactive Glass (Clickable Cards)
// Rises and glows on hover.
.surface-glass-action {
  @include glass-float($interactive: true);
  cursor: pointer;
}

// B. SUNK SURFACES (Negative Z)
// --------------------------------------------------------------------------

// Recessed areas (for groupings, not just inputs)
.surface-sunk {
  @include glass-sunk;
}

// C. SOLID SURFACES (Opaque)
// --------------------------------------------------------------------------

// Pure Void Background (Useful for masking or solid headers)
.surface-void {
  background: var(--bg-canvas);
  // Optional: add a subtle border to define edges against other void elements
  border: var(--physics-border-width) solid var(--border-shadow);
}

// Spotlight Background (Slightly lighter, useful for active sections)
.surface-spotlight {
  background: var(--bg-spotlight);
  border: var(--physics-border-width) solid var(--border-shadow);
}

// ==========================================================================
// 4. SETTINGS GRID (Dashboard Layout)
// ==========================================================================
// Usage:
// <div class="settings-grid">
//   <div class="settings-label">Label</div>
//   <div class="settings-content">...inputs...</div>
// </div>

.settings-grid {
  display: grid;
  width: 100%;
  gap: var(--space-sm);

  // 1. MOBILE (Stacked)
  grid-template-columns: 1fr;
  align-items: start; // Align to top, not center

  // 2. DESKTOP (Side-by-Side)
  @include respond-up(small-desktop) {
    // 10rem = 40 units (40 * 0.25rem = 10rem)
    // We multiply by var(--density, 1) so this width breathes with the user settings.
    grid-template-columns: calc(40 * var(--unit) * var(--density, 1)) 1fr;
    gap: var(--space-lg);
  }

  // 3. INTERNAL PARTS
  .settings-label {
    @extend .text-h4;
    color: var(--text-dim);
    margin-block: auto;
    text-align: left; // Match your old UI (Left aligned)

    @include mobile-only {
      text-align: center; // Labels stay left-aligned on mobile
      padding-bottom: calc(var(--space-sm) - var(--space-xs) / 2);
    }

    // OPTICAL ALIGNMENT
    // Inputs have padding. Text needs to move down slightly to line up
    // with the text *inside* the input.
    // padding-top: 0.75rem;
  }

  .settings-content {
    display: flex;
    flex-direction: column;
    gap: calc(
      var(--space-sm) + var(--space-xs) / 2
    ); // Increased gap between rows slightly
    width: 100%;
    margin-block: auto;

    &.flow-row {
      flex-direction: row;
      flex-wrap: wrap;
    }
  }
}
