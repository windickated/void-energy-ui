@use '../abstracts' as *;

/* ==========================================================================
   VOID ENERGY BUTTON SYSTEM
   ==========================================================================
   
   PURPOSE:
   Defines the interactive elements of the system. In Void Energy, buttons are 
   not just colored rectangles; they are physical surfaces that react to touch.

   PHILOSOPHY: "Interaction is Energy"
   - Resting state = Potential Energy (Subtle border/glass).
   - Hover/Focus = Kinetic Energy (Glow, Rise, Brightness).
   
   --------------------------------------------------------------------------
   See global.scss for full API documentation.
   -------------------------------------------------------------------------- */

// ==========================================================================
// BUTTONS
// ==========================================================================

// 1. BASE BUTTON & VARIANTS
// --------------------------------------------------------------------------
// We define everything inside this block to ensure specificity works correctly.
button:not(.btn-void),
.btn {
  // --- A. Layout & Accessibility ---
  min-width: 2.75rem;
  min-height: 2.75rem;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  gap: calc(var(--space-sm) - var(--space-xs) / 2);
  padding-block: 0;
  padding-inline: calc(var(--space-sm) + var(--space-xs) / 2);

  // --- B. Typography ---
  font-family: var(--font-body);
  font-weight: 600;
  font-size: 0.875rem;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: var(--text-main);
  text-decoration: none;
  line-height: 1;

  // --- C. The Physics (Glass) ---
  background: var(--bg-surface);

  // Borders rely on the physics engine variables
  border: var(--physics-border-width) solid var(--border-highlight);
  border-radius: var(--radius-base);

  // Transitions
  transition:
    color var(--speed-fast) var(--ease-flow),
    background-color var(--speed-fast) var(--ease-flow),
    border-color var(--speed-fast) var(--ease-snap),
    box-shadow var(--speed-fast) var(--ease-snap),
    transform var(--speed-fast) var(--ease-stabilize);

  cursor: pointer;
  position: relative;
  overflow: hidden;

  @at-root [data-mode='light'] & {
    background: blend(var(--bg-surface), var(--energy-primary), 5%);
  }

  // --- D. Interaction States ---

  &:focus-visible {
    outline: none;
    border-color: var(--energy-primary);
    box-shadow:
      0 0 0 2px rgba(0, 0, 0, 0.5),
      0 0 0 4px var(--energy-primary);
  }

  @media (hover: hover) {
    &:hover:not(:disabled) {
      border-color: var(--energy-primary);
      transform: translateY(-2px);

      // Default (Void) Behavior
      color: #ffffff;
      box-shadow:
        0 0 10px fade(var(--energy-primary), 60%),
        inset 0 0 5px fade(var(--energy-primary), 80%);
      text-shadow: 0 0 8px fade(var(--energy-primary), 40%);

      // Light Mode Override
      @at-root [data-mode='light'] & {
        color: var(--energy-primary);
        border-color: var(--energy-primary);
        text-shadow: none;
        box-shadow: none;
      }
    }
  }

  &:active:not(:disabled) {
    transform: translateY(0);
    border-color: var(--energy-secondary);
    box-shadow: none;
  }

  &:disabled {
    background: rgba(125, 125, 125, 0.1);
    border-color: transparent;
    color: var(--text-mute);
    cursor: not-allowed;
    box-shadow: none;
  }

  // ========================================================================
  // 2. THE GEMINI LASER (CTA)
  // Nested to override Base Styles properly
  // ========================================================================
  &.btn-cta:not(:disabled) {
    @include gemini-laser;

    // Explicitly kill the base button background/border
    background: transparent;
    border: none;

    color: var(--energy-primary);
    font-weight: 800;
    min-height: var(--space-xl);
    padding-inline: var(--space-md);

    border-radius: var(--radius-full); // Pill Shape

    @media (hover: hover) {
      &:hover:not(:disabled) {
        // Reset base button hover effects that clash
        background: transparent;
        border: none;

        color: #ffffff;

        // The Glow (Halo around the box)
        box-shadow: 0 0 30px fade(var(--energy-primary), 50%);
        text-shadow: 0 0 10px var(--energy-primary);

        // CTA Light Mode
        @at-root [data-mode='light'] & {
          color: var(--energy-primary);
          text-shadow: none;
          box-shadow: none;
        }

        // TERMINAL OVERRIDE: The "Hard Glitch"
        @at-root [data-physics='retro'] & {
          text-shadow: none;
        }
      }
    }
  }

  // ========================================================================
  // 3. SEMANTIC VARIANTS
  // Nested to override Base Styles properly
  // ========================================================================

  // Mixin for clean overrides
  @mixin btn-variant($color-var) {
    border-color: fade($color-var, 50%);
    background: fade($color-var, 90%);
    color: $color-var;

    @media (hover: hover) {
      &:hover:not(:disabled) {
        border-color: $color-var;
        background: fade($color-var, 85%);
        color: #ffffff;

        box-shadow:
          0 0 10px fade($color-var, 60%),
          inset 0 0 5px fade($color-var, 80%);
        text-shadow: 0 0 8px fade($color-var, 40%);

        @at-root [data-mode='light'] & {
          color: $color-var;
          background: fade($color-var, 90%);
          box-shadow: none;
          text-shadow: none;
        }
      }
    }
  }

  &.btn-orb:not(:disabled) {
    @include btn-variant(var(--color-premium));
  }
  &.btn-system:not(:disabled) {
    @include btn-variant(var(--color-system));
  }
  &.btn-signal:not(:disabled) {
    @include btn-variant(var(--color-success));
  }
  &.btn-alert:not(:disabled) {
    @include btn-variant(var(--color-error));
  }
}

// 4. UTILITIES
// --------------------------------------------------------------------------

// Naked Reset (Use this class to opt-out of the block above)
.btn-void {
  appearance: none;
  background: transparent;
  border: none;
  padding: 0;
  margin: 0;
  cursor: pointer;
  color: inherit;
  font: inherit;
  min-width: unset;
  min-height: unset;
  display: inline-flex;
}

// Icon Button
.btn-icon {
  padding: 0;
  width: 2.75rem;
  height: 2.75rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}
